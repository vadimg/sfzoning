<html>
<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-120785721-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-120785721-1');
</script>

<!-- Primary Meta Tags -->
<title>54% of San Francisco homes are in buildings that would be illegal to build today</title>
<meta name="title" content="54% of San Francisco homes are in buildings that would be illegal to build today" />
<meta name="description" content="To comply with today's laws, 130,748 homes would have to be destroyed, evicting around 310,000 people." />

<!-- Open Graph / Facebook -->
<meta property="og:type" content="website" />
<meta property="og:title" content="54% of San Francisco homes are in buildings that would be illegal to build today" />
<meta property="og:description" content="To comply with today's laws, 130,748 homes would have to be destroyed, evicting around 310,000 people." />
<meta property="og:image" content="/img/sf_illegal_homes.jpg" />

<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image" />
<meta property="twitter:title" content="54% of San Francisco homes are in buildings that would be illegal to build today" />
<meta property="twitter:description" content="To comply with today's laws, 130,748 homes would have to be destroyed, evicting around 310,000 people." />
<meta property="twitter:image" content="https://sfzoning.deapthoughts.com/img/sf_illegal_homes_twitter.jpg" />

<script src="https://api.mapbox.com/mapbox-gl-js/v0.44.1/mapbox-gl.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.11/handlebars.min.js"></script>
<script src="https://mozilla.github.io/nunjucks/files/nunjucks.min.js"></script>
<link href="https://api.mapbox.com/mapbox-gl-js/v0.44.1/mapbox-gl.css" rel="stylesheet" />
<style>

body {
  margin: 0;
  font: 12px "Helvetica Neue", Arial, Helvetica, sans-serif;
  -webkit-font-smoothing: antialiased;
}

a {
  color: #bbb;
  text-decoration-style: solid;
}

a:hover {
  color: #e75ea3;
}

#loader {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
  width: 100%;
  background-color: rgba(0,0,0,0.33);
}

#header {
  background-color: #262626;
  color: #eee;
  box-shadow: 0px 1px 2px rgba(0, 0, 0, 0.5);
  z-index: 1;
  text-align: center;
  font-size: 22px;
  margin: 0;
  padding: 4px;
}

#container {
  width: 100%;
  height: 100%;

  display: flex;
  flex-flow: column;
}

#map {
  flex-grow: 1;
  flex-shrink: 1;
  flex-basis: auto;
}

/* get rid of the dumb blue border when map is in focus */
.mapboxgl-canvas:focus { outline: none; }

.mapboxgl-popup {
  max-width: 400px;
  font: 12px "Helvetica Neue", Arial, Helvetica, sans-serif;
}

.mapboxgl-popup-anchor-top .mapboxgl-popup-tip,
.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip,
.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip {
    border-bottom-color: #262626;
    }
.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip,
.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip,
.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip {
    border-top-color: #262626;
    }
.mapboxgl-popup-anchor-left .mapboxgl-popup-tip {
    border-right-color: #262626;
    }
.mapboxgl-popup-anchor-right .mapboxgl-popup-tip {
    border-left-color: #262626;
    }

.mapboxgl-popup-content {
  background: #262626;
}

.mapboxgl-popup-close-button {
  color: #eee;
}

.mapboxgl-popup-content {
  color: #bbb;
}

.mapboxgl-popup-content ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.mapboxgl-popup-content li {
  margin-top: 3px;
  margin-bottom: 3px;
}

.mapboxgl-popup-content h3 {
  margin-top: 4px;
  margin-bottom: 4px;
  font-size: 17px;
  line-height: 18px;
  color: #eee;
}

.mapboxgl-popup-content a:link,
.mapboxgl-popup-content a:visited {
  color: currentColor;
}

.mapboxgl-popup-content a:hover {
  color: #e75ea3;
}

.legend {
  background-color: #262626;
  color: #ddd;
  border-radius: 3px;
  bottom: 30px;
  box-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
  font: 12px "Helvetica Neue", Arial, Helvetica, sans-serif;
  padding: 10px;
  position: absolute;
  right: 10px;
  z-index: 1;
  width: 350px;
  max-height: 550px;
  overflow: auto;
}

/* force a scrollbar to always appear */
.legend::-webkit-scrollbar {
    -webkit-appearance: none;
    width: 7px;
}
.legend::-webkit-scrollbar-thumb {
    border-radius: 4px;
    background-color: rgba(0,0,0,.5);
    -webkit-box-shadow: 0 0 1px rgba(255,255,255,.5);
}

.legend {
  font-size: 14px;
  font-weight: 500;
  color: #bbb;
}


.legend h3 {
  margin-top: 15px;
  margin-bottom: 4px;
  font-size: 17px;
  line-height: 18px;
  color: #eee;
}

.legend h2 {
  margin-top: 20px;
  margin-bottom: 10px;
  color: #eee;
  text-align: center;
  font-size: 22px;
}

.legend .color-box {
  width: 25px;
  height: 25px;
  line-height: 25px;
  display: inline-block;
  opacity: 0.8;
  text-align: center;
  color: #000;
}

#legend-data {
  justify-content: space-between;
  display: flex;
  margin-top: 10px;
  margin-left: 17px;
  margin-right: 17px;
}

.legend .section {
  margin-top: 10px;
  margin-left: 5px;
  margin-right: 5px;
}

.legend ul {
  margin: 0;
  padding-left: 7px;
  padding-right: 17px;
}

.legend li {
  list-style-type: disc;
  margin: 4px 0 4px 10px;
  line-height: 16px;
}

.legend p {
  margin-top: 4px;
}

</style>
</head>
<body>
<div id="container">
  <h1 id="header"></h1>
  <div id="map">
    <div id="loader">
      <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="80px" height="80px" viewBox="0 0 40 40" enable-background="new 0 0 40 40" xml:space="preserve">
        <path opacity="0.2" fill="#000" d="M20.201,5.169c-8.254,0-14.946,6.692-14.946,14.946c0,8.255,6.692,14.946,14.946,14.946
        s14.946-6.691,14.946-14.946C35.146,11.861,28.455,5.169,20.201,5.169z M20.201,31.749c-6.425,0-11.634-5.208-11.634-11.634
        c0-6.425,5.209-11.634,11.634-11.634c6.425,0,11.633,5.209,11.633,11.634C31.834,26.541,26.626,31.749,20.201,31.749z" />
        <path fill="#000" d="M26.013,10.047l1.654-2.866c-2.198-1.272-4.743-2.012-7.466-2.012h0v3.312h0
        C22.32,8.481,24.301,9.057,26.013,10.047z">
        <animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 20 20" to="360 20 20" dur="0.5s" repeatCount="indefinite" />
        </path>
      </svg>
    </div>
  </div>
  <div id="legend" class="legend">
    <div class="section">
      <h3>About this map</h3>
      <p>Over the past 100 years, San Francisco added numerous restrictions on housing construction. These restrictions are so severe that many existing homes would be illegal to build today. This map shows how many homes would be illegal on each parcel of land:
      <div id="legend-data"></div>
    </div>
    <div class="fun-facts section" id="fun-facts"></div>
    <div class="explainer section" id="explainer"></div>
  </div>
</div>

<!-- templates -->
<div style="display: none">
  <div id="header-template">{{ (100 * num_units_in_illegal_building / num_units) | round }}% of San Francisco homes are in buildings that would be illegal to build today</div>
  <div id="fun-facts-template">
    <h3>Fun Facts</h3>
    <ul>
      <li>{{ (100 * num_illegal_lots / num_lots) | round }}% of the buildings in San Francisco would be illegal to build today</li>
      <li>{{ (100 * num_units_in_illegal_building / num_units) | round }}% of the homes in San Francisco are in buildings that would be illegal to build today</li>
      <li>To comply with today's laws, {{ num_illegal_units | commas }} homes would have to be destroyed, evicting around {{ (2.36 * num_illegal_units) | round(-4) | round | commas }} people.</li>
    </ul>
  </div>
  <div id="popup-template">
    <h3><a href="https://www.google.com/maps/place/{{ address }} San Francisco, CA" target="_blank">{{ address }}</a></h3>
    <ul class="list-group">
      <li class="list-group-item"><strong>Illegal Homes: {{ illegal_units }}</strong></li>
      <li class="list-group-item">Illegal because: {{ reasons }}</li>
      <li class="list-group-item">Homes: {{ units }}</li>
      <li class="list-group-item">Height: {{ max_median_height | round }} ft</li>
      <li class="list-group-item">Allowed Height: {{ allowed_height }} ft</li>
      <li class="list-group-item">Lot Size: {{ lot_sq_ft | round }} sq ft</li>
      <li class="list-group-item">Minimum Allowed Lot Size: {{ minimum_lot_sq_ft }} sq ft</li>
      <li class="list-group-item">Zoning code: {{ zoning_code }}</li>
      <li class="list-group-item">Allowed Homes per zoning code:
        {% if allowed_units_density > 10000000 %}
        No limit
        {% else %}
        {{ allowed_units_density | round }}
        {% endif %}
      </li>
      <li class="list-group-item">Year built: {{ year_built }}</li>
    </ul>
  </div>
  <div id="explainer-template">
    <h3>Why are these homes illegal to build?</h3>
    <p>These buildings aren't illegal to build because of safety reasons or any construction deficiencies - they are only illegal due to regulations called zoning laws that San Francisco passed to restrict the density of housing in certain areas, <a target="_blank" href="https://www.epi.org/publication/the-color-of-law-a-forgotten-history-of-how-our-government-segregated-america/">originally to keep poor minorities out of white neighborhoods</a>.
    <p>Starting in <a target="_blank" href="https://archive.org/details/sf-zoning-1921">1921</a>, San Francisco has been steadily passing zoning laws to restrict housing construction in wealthy neighborhoods. This <a target="_blank" href="https://twitter.com/enf/status/999030803609899013">accelerated after 1968</a> when the <a target="_blank" href="https://en.wikipedia.org/wiki/Civil_Rights_Act_of_1968#Title_VIII%E2%80%93IX:_Fair_Housing_Act">Fair Housing Act</a> banned explicit race discrimination. Because minorities were poorer than whites and dense housing such as apartments is usually cheaper than single-family homes, the goal was to ban the construction of housing that poor minorities could afford.
    <p>These days, many people who don't have explicitly racist motivations support zoning laws because they like the status quo, even though <a target="_blank" href="http://sfzoning.deapthoughts.com">the status quo bans the construction of affordable housing in most of the city</a>.

    <h3>How does San Francisco ban affordable housing?</h3>
    <p>If your goal is to make housing as expensive as possible, the best way to do it is to require lots of land per home, because land in cities is very expensive. San Francisco does this in a multitude of ways, but I decided to focus on 3 of them:
    <ul>
      <li><strong>Minimum lot size</strong>: San Francisco mandates that a lot must be at least 2,500 square feet (or 4,000 sqft in some cases) in order to build a home on it. Since a <a target="_blank" href="https://www.zillow.com/homedetails/415-Ivy-St-San-Francisco-CA-94102/15078362_zpid/?">decent single-family home could be built on a 500 sqft lot</a>, and a <a target="_blank" href="https://www.zillow.com/homedetails/2325-Ulloa-St-San-Francisco-CA-94116/15123381_zpid/">very nice single-family home can be built on a 1,200 sqft lot</a>, the minimum lot size requirement greatly reduces the amount of homes that could be built in San Francisco and increases the price of each home. {{ reason_counts["lot too small"] | commas }} homes would be illegal to build today because the lot size is too small.</li>
      <li><strong>Density limits</strong>: San Francisco mandates explicit density limits, from prohibiting apartments entirely (<a target="_blank" href="http://sfzoning.deapthoughts.com">in 76% of the city</a>) to mandating a minimum lot size per apartment (almost everywhere else). The sole reason for these limits is to make housing more scarce and therefore more expensive. San Francisco limits density in many other ways, such as <a target="_blank" href="https://en.wikipedia.org/wiki/Floor_area_ratio">floor-to-area ratio</a>, <a target="_blank" href="https://en.wikipedia.org/wiki/Setback_(land_use)">setback requirements</a>, etc. but to keep things simple, I looked only at the minimum lot size per apartment for this map. {{ reason_counts["too dense"] | commas }} homes would be illegal to build today because of density limits.</li>
      <li><strong>Height limits</strong>: When land becomes expensive, developers can still create inexpensive homes by building multiple apartments on the same plot of land. Each apartment has to pay for only a fraction of the land cost, which can <a target="_blank" href="https://www.rent.com/blog/single-family-home-vs-apartment/">make apartments significantly cheaper than single-family homes</a>. The taller the apartment building, the less significant the cost of the land becomes, so San Francisco limits this savings by limiting the height of new buildings to 40 feet in most of the city. {{ reason_counts["too tall"] | commas }} homes would be illegal to build today because of height limits.</li>
    </ul>
    <p>Whenever San Francisco creates a new restriction, homes that already exist are grandfathered in rather than demolished. That's where all these "homes illegal to build today" come from.

    <h3>How can you say San Francisco purposely bans affordable housing? All its leaders constantly talk about building more affordable housing!</h3>
    <p>Sorry to break it to you, but politicians lie. Think about it: they say they want more affordable housing all the time, yet very little affordable housing gets built, and <a target="_blank" href="https://sf.curbed.com/2019/3/15/18267525/san-francisco-zumper-most-expensive-worldwide">San Francisco remains the most expensive city in the world</a>. Meanwhile, you can rent <a target="_blank" href="https://web.archive.org/web/20210102184055/https://houston.craigslist.org/apa/d/houston-free-wi-fi-in-clubhouse-and/7253671989.html">a nice apartment in Houston for $600/month</a>. San Francisco politicians blame all sorts of scapegoats for this: techies, greedy developers, speculators, capitalism, etc. but Houston is also very capitalist, its developers and speculators are just as greedy, and it even has a <a target="_blank" href="https://www.erieri.com/salary/job/petroleum-engineer/united-states/texas/houston">booming industry that pays engineers high salaries</a> - the main difference is that Houston doesn't have zoning laws.

    <h3>But how can you say that zoning laws are racist? San Francisco always tries to elevate the concerns of BIPOC communities!</h3>
    <p>These laws were originally created for racist reasons - that is a <a target="_blank" href="https://www.epi.org/publication/the-color-of-law-a-forgotten-history-of-how-our-government-segregated-america/">well-documented fact</a>, despite <a target="_blank" href="https://archive.is/A7kR1">what some San Francisco politicians claim</a>. These days, supporters of zoning probably don't have explicitly racist motivations. Instead, they are concerned about traffic, parking, shadows, "neighborhood character", or just don't like change and aren't personally affected by high rent.
    <p>Still, even if the <em>intent</em> of zoning laws isn't racist, their <em>effect</em> has racist impacts. <a target="_blank" href="https://thebolditalic.com/the-dream-vs-reality-on-being-black-in-san-francisco-8a77f2176d1a">San Francisco's Black population declined from 13% of the city in the 1970s to 5.5% today</a>. In contrast, zoning-free <a target="_blank" href="https://webcache.googleusercontent.com/search?q=cache:OPBV3wCfme4J:https://www.latimes.com/opinion/op-ed/la-oe-0501-renn-reverse-great-migration-20160501-story.html+&cd=48&hl=en&ct=clnk&gl=us">Houston added 100,000 Black residents from 2010 to 2015</a>, and Black people are now <a target="_blank" href="https://www.census.gov/quickfacts/fact/table/houstoncitytexas/PST045219">23% of Houston's population</a>.

    <h3>What can I do to fix this?</h3>
    <p>As far as I know, there is only one organization in San Francisco working to fix this: <a target="_blank" href="https://yimbyaction.org/">YIMBY Action</a>. At the California state level, <a target="_blank" href="https://cayimby.org/">California YIMBY</a> is working on fixing zoning laws statewide. Joining these organizations will teach you how to push your local politicians to make reforms to zoning laws.
    <p>Some places such as <a target="_blank" href="https://www.berkeleyside.com/2021/02/24/berkeley-denounces-racist-history-of-single-family-zoning-begins-2-year-process-to-change-general-plan">Berkeley</a>, <a target="_blank" href="https://www.nytimes.com/2018/12/13/us/minneapolis-single-family-zoning.html">Minneapolis</a>, and the <a target="_blank" href="https://www.npr.org/2019/07/01/737798440/oregon-legislature-votes-to-essentially-ban-single-family-zoning">entire state of Oregon</a> have already taken steps to <a target="_blank" href="https://www.csmonitor.com/USA/Politics/2021/0308/California-housing-crunch-Is-the-answer-to-end-single-family-zoning">reform these racist laws</a>, but we can't declare victory yet. <a target="_blank" href="https://www.nytimes.com/interactive/2019/06/18/upshot/cities-across-america-question-single-family-zoning.html">Most American cities still have zoning laws that exclude poor people</a>; we have a lot of work left to do.

    <h2>FAQ</h2>

    <h3>Where did you get this data?</h3>
    <p>The data comes from <a target="_blank" href="https://data.sfgov.org/browse?category=Housing+and+Buildings">San Francisco's Open Data</a>. The code used to create this map is on <a target="_blank" href="https://github.com/vadimg/sfzoning">Github</a>.

    <h3>I notice there's a building built last year that you claim is illegal to build. How is that possible?</h3>
    <p>Well-connected developers can apply for a <a target="_blank" href="https://en.wikipedia.org/wiki/Special-use_permit">conditional use permit</a> to get a per-project exemption from zoning laws. The city does not need consistent reasons for granting or rejecting these permits, so this is an easy way for politicians to grant special favors to friendly developers.
  </div>
  <div id="legend-item-template">
    <div class="color-box" style="background-color: {{ color }}">
      {% if num >= 5 %}
      5+
      {% else %}
      {{ num }}
      {% endif %}
    </div>
  </div>
</div>
<!-- end templates -->

<script>
mapboxgl.accessToken = 'pk.eyJ1IjoiZGltdmEiLCJhIjoiY2plYzhtMTM5MG5yazJ4bGE0OHZrcHpnZCJ9.u9hqKMLwpq-JHGyhAW2GeQ';

nunjucks.configure('views', { autoescape: true });
var env = new nunjucks.Environment();

env.addFilter('round', function(num, places) {
    var e = Math.pow(10, places || 0);
    return Math.round(num*e) / e;
});

env.addFilter('commas', function(num) {
    var parts = num.toString().split(".");
    parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    return parts.join(".");
});

function compile(elemId) {
  var html = document.getElementById(elemId).innerHTML;

  // unescape < and > symbols
  html = html.replace(/&lt;/g, '<');
  html = html.replace(/&gt;/g, '>');

  return nunjucks.compile(html, env);
}

var map = new mapboxgl.Map({
    container: 'map', // container id
    style: 'mapbox://styles/mapbox/dark-v9',
});

// Hide loading bar once tiles from geojson are loaded
map.on('data', function(e) {
    if (e.dataType === 'source' && e.sourceId === 'zones-layer') {
        document.getElementById("loader").style.display = "none";
    }
});

// disable map rotation using right click + drag
map.dragRotate.disable();

// disable map rotation using touch rotation gesture
map.touchZoomRotate.disableRotation();

// add zoom controls to the map
map.addControl(new mapboxgl.NavigationControl({showCompass: false}));

// add geolocation control to the map
map.addControl(new mapboxgl.GeolocateControl({
    positionOptions: {
        enableHighAccuracy: true
    },
    trackUserLocation: true
}));

// fit all of SF in the viewport
map.fitBounds([
  [-122.5203765565384, 37.700033803604006],
  [-122.30764514054817, 37.813050877104246],
]);


var popupTemplate = compile("popup-template");
var headerTemplate = compile("header-template");
var legendItemTemplate = compile("legend-item-template");
var funFactsTemplate = compile("fun-facts-template");
var explainerTemplate = compile("explainer-template");

$.getJSON('generated/sf/illegal_homes_key_data.json', function(keyData) {
  document.getElementById('header').insertAdjacentHTML('beforeend', headerTemplate.render(keyData));
  document.title = headerTemplate.render(keyData);
  document.getElementById('fun-facts').insertAdjacentHTML('beforeend', funFactsTemplate.render(keyData));
  document.getElementById('explainer').insertAdjacentHTML('beforeend', explainerTemplate.render(keyData));

  var legend = document.getElementById('legend-data');

  keyData.key.forEach(function(data) {
    legend.insertAdjacentHTML('beforeend', legendItemTemplate.render(data));
  });

  map.on('load', function () {
    map.addLayer({
        'id': 'zones-layer',
        'type': 'fill',
        'source': {
            'type': 'geojson',
            'data': 'generated/sf/illegal_homes.geojson'
        },
        'paint': {
            'fill-opacity': 0.7,
            'fill-color': ['get', 'fill']
        }
    });

    // When a click event occurs on a feature in the states layer, open a popup at the
    // location of the click, with description HTML from its properties.
    map.on('click', 'zones-layer', function (e) {
      var prop = e.features[0].properties;
      prop['lot_size'] = keyData.lot_size;

      new mapboxgl.Popup()
          .setLngLat(e.lngLat)
          .setHTML(popupTemplate.render(prop))
          .addTo(map);
    });
  });
});

</script>
</body>
</html>
